% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hsreg.R
\name{hsreg}
\alias{hsreg}
\title{Fit Bayesian Linear Regression with the Horseshoe Prior}
\usage{
hsreg(
  y,
  X,
  penalized = NULL,
  lambda_scale = 1,
  tau_scale = 1,
  n_mcmc = 1000,
  burnin = 500,
  thin = 1,
  level = 0.95,
  scale_X = FALSE,
  seed = NULL,
  saving = NULL,
  varnames = NULL,
  verbose = TRUE,
  chains = 1,
  cores = NULL
)
}
\arguments{
\item{y}{Numeric vector of length n. The outcome variable.}

\item{X}{Numeric matrix of dimension n x p. The design matrix.}

\item{penalized}{Logical vector of length p, or \code{NULL}. \code{TRUE}
= horseshoe prior (shrinkage); \code{FALSE} = flat prior. Default
(\code{NULL}): all penalized.}

\item{lambda_scale}{Positive scalar. Scale of the half-Cauchy prior on
local shrinkage. Default: 1.}

\item{tau_scale}{Positive scalar. Scale of the half-Cauchy prior on
global shrinkage. Default: 1.}

\item{n_mcmc}{Positive integer. Number of post-burnin MCMC draws per chain.
When \code{chains > 1}, total draws = \code{chains * n_mcmc}. Default: 1000.}

\item{burnin}{Non-negative integer. Burnin iterations (per chain). Default: 500.}

\item{thin}{Positive integer. Thinning interval (per chain). Default: 1.}

\item{level}{Numeric in (0, 1). Credible interval level. Default: 0.95.}

\item{scale_X}{Logical. If \code{TRUE}, standardize columns of X to unit
variance before sampling, then rescale coefficients back to the original
scale. Useful when columns of X have very different scales. Default: FALSE.}

\item{seed}{Integer or \code{NULL}. If not \code{NULL}, call
\code{set.seed(seed)} before sampling for reproducibility. Default: NULL.}

\item{saving}{Character string or \code{NULL}. If not \code{NULL}, save
the full posterior draws to a file. The format is detected from the
extension: \code{.rds} (default) or \code{.csv}. Default: NULL.}

\item{varnames}{Character vector of length p, or \code{NULL}. Names for
the coefficients. If \code{NULL}, uses \code{colnames(X)} or generates
\code{X1, X2, ...}. Default: NULL.}

\item{verbose}{Logical. Print progress. Default: TRUE.}

\item{chains}{Positive integer. Number of independent MCMC chains. Each
chain runs a full \code{n_mcmc} post-burnin draws. When \code{chains = 1}
(default), behavior is bit-for-bit identical to single-chain mode. Per-chain
seeds are derived from the master Mersenne Twister stream (not L'Ecuyer-CMRG),
which is sufficient for typical use (2-10 chains). Default: 1.}

\item{cores}{Positive integer or \code{NULL}. Number of parallel workers for
multi-chain runs. If \code{NULL} (default), auto-detects as
\code{max(1, floor(detectCores(logical = FALSE) / 2))}, capped at
\code{chains}. Uses PSOCK clusters for cross-platform compatibility
(works on Windows, macOS, and Linux). When \code{cores = 1}, chains run
sequentially with no parallel overhead. Default: NULL.}
}
\value{
An S3 object of class \code{"hsreg"}, which is a list with:
  \describe{
    \item{coefficients}{Named numeric vector of length p: posterior means.}
    \item{b_sd}{Named numeric vector: posterior standard deviations.}
    \item{b_lower}{Named numeric vector: lower credible interval bounds.}
    \item{b_upper}{Named numeric vector: upper credible interval bounds.}
    \item{vcov}{p x p posterior variance-covariance matrix.}
    \item{sigma2}{Scalar: posterior mean of \eqn{\sigma^2}.}
    \item{tau2}{Scalar: posterior mean of \eqn{\tau^2}.}
    \item{beta_draws}{p x n_mcmc matrix: full posterior draws for beta.}
    \item{sigma2_draws}{Numeric vector: posterior draws for \eqn{\sigma^2}.}
    \item{tau2_draws}{Numeric vector: posterior draws for \eqn{\tau^2}.}
    \item{lambda2_draws}{p_pen x n_mcmc matrix: posterior draws for \eqn{\lambda_j^2}.}
    \item{pen_idx, free_idx}{Integer vectors: penalized/free column indices.}
    \item{penalized}{Logical vector of length p: penalization flags.}
    \item{n, p, p_pen}{Integers: sample size, total predictors, penalized count.}
    \item{n_mcmc, burnin, thin, level}{MCMC settings.}
    \item{lambda_scale, tau_scale}{Prior scale parameters.}
    \item{X_sd}{Numeric vector or \code{NULL}: column SDs if \code{scale_X = TRUE}.}
    \item{varnames}{Character vector: coefficient names.}
    \item{seed, rng_state}{Seed and RNG state for reproducibility.}
    \item{n_chol_fallback}{Integer: Cholesky ridge fallback count.}
    \item{chains}{Integer: number of chains run.}
    \item{cores}{Integer: number of parallel workers used.}
    \item{total_draws}{Integer: total MCMC draws (\code{chains * n_mcmc}).}
    \item{rhat_beta}{Named numeric vector: Gelman-Rubin R-hat per coefficient.
      \code{NULL} if \code{chains = 1}.}
    \item{rhat_sigma2, rhat_tau2}{Scalar R-hat for variance parameters.
      \code{NULL} if \code{chains = 1}.}
    \item{rhat_max}{Scalar: maximum R-hat across all parameters.
      \code{NULL} if \code{chains = 1}.}
    \item{ess_beta}{Named numeric vector: ESS per coefficient.}
    \item{ess_sigma2, ess_tau2, ess_min}{ESS diagnostics.}
    \item{X, y}{Stored data (for \code{predict}).}
    \item{call}{The matched call.}
  }
}
\description{
Fits a Bayesian linear regression model using the horseshoe prior
(Carvalho, Polson & Scott, 2010) via the auxiliary-variable Gibbs sampler
of Makalic & Schmidt (2015). Supports selective per-parameter penalization:
user-specified coefficients can receive the horseshoe prior (shrinkage)
while others receive a flat (improper) prior (no shrinkage).
}
\details{
Returns an S3 object of class \code{"hsreg"} with full method support:
\code{print}, \code{summary}, \code{coef}, \code{vcov}, \code{predict},
and \code{confint}.
}
\examples{
set.seed(42)
n <- 100; p <- 20
X <- matrix(rnorm(n * p), n, p)
beta_true <- c(rep(3, 5), rep(0, 15))
y <- X \%*\% beta_true + rnorm(n)

fit <- hsreg(y, X, n_mcmc = 200, burnin = 100, verbose = FALSE)
print(fit)
predict(fit, type = "xb")[1:5]

}
\references{
Carvalho, C. M., Polson, N. G., & Scott, J. G. (2010). The horseshoe
estimator for sparse signals. \emph{Biometrika}, 97(2), 465-480.

Makalic, E. & Schmidt, D. F. (2015). A simple sampler for the horseshoe
estimator. \emph{arXiv:1508.03884v4}.
}
